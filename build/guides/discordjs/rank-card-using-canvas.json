{"meta":{"title":"Rank card using canvas","description":"How to create a awesome rank card using only canvas!","tags":"discordjs, rank card, canvas","image":"https://camo.githubusercontent.com/40129aa4640399b5e65cc3c101361a6a0b5d6467/68747470733a2f2f646973636f72642e6a732e6f72672f7374617469632f6c6f676f2e737667","writtenAt":"18 Jun 2020 16:15"},"body":"<h2>Preview</h2>\n<p>Output:</p>\n<img src=\"https://media.discordapp.net/attachments/706710007441260595/719947058047352862/rank.png\">\n<div class=\"admonition warning\">\n<p class=\"admonition-title\">warning</p>\n<p>The above using a different font</p>\n</div>\n<br>\n<p>Base:</p>\n<img src=\"/assets/images/others/discord-js-rank-card.png\">\n<hr>\n<h2>Alternative</h2>\n<p>If you are a beginner, you can use <a href=\"https://www.npmjs.com/package/canvacord\">canvacord</a> to do this!</p>\n<pre><code class=\"language-bash\">$ npm install canvacord\n</code></pre>\n<div class=\"admonition info\">\n<p class=\"admonition-title\">info</p>\n<p>Canvacord has the same code below!</p>\n</div>\n<hr>\n<h2>Installing Canvas</h2>\n<p>Open your command prompt (or) powershell and run the following command.</p>\n<pre><code class=\"language-bash\">$ npm install canvas\n</code></pre>\n<hr>\n<h2>Creating a canvas</h2>\n<p>Creating a new canvas to begin the rank card!</p>\n<pre><code class=\"language-javascript\">const Canvas = require(&quot;canvas&quot;);\nconst canvas = Canvas.createCanvas(934, 282); // Use this measurement if you are using the card in this tutorial\nconst ctx = canvas.getContext(&quot;2d&quot;);\n</code></pre>\n<hr>\n<h2>Rank Card base</h2>\n<p>You can use the base picture used in this tutorial or make your own one!</p>\n<pre><code class=\"language-javascript\">const Canvas = require(&quot;canvas&quot;);\nconst canvas = Canvas.createCanvas(934, 282);\nconst ctx = canvas.getContext(&quot;2d&quot;);\n\nconst rankCard = await Canvas.loadImage(&quot;https://zyrouge.gq/assets/images/others/discord-js-rank-card.png&quot;);\nctx.drawImage(rankCard, 0, 0, canvas.width, canvas.height);\n\nconst font = &quot;Arial&quot;; // Default font\n</code></pre>\n<hr>\n<h2>Username</h2>\n<p>Now lets write the username on the card</p>\n<pre><code class=\"language-javascript\">ctx.font = `bold 36px ${font}`; // Weight - Bold, Size - 36px\nctx.fillStyle = &quot;#FFFFFF&quot;; // Color in hex value\nctx.textAlign = &quot;start&quot;; // Position of text starting\nconst name = username &gt; 7 ? username.substring(0, 7).trim() + '...' : username; // Shorten name if its long\nctx.fillText(`${name}`, 264, 164); // Writing the username\n</code></pre>\n<hr>\n<h2>Discrim</h2>\n<p>Writing Discriminator (<code>#0950</code>) in the card</p>\n<pre><code class=\"language-javascript\">ctx.font = `36px ${font}`; // Weight - Normal\nctx.fillStyle = &quot;rgba(255, 255, 255, 0.4)&quot;; // Reducing opacity using rgba\nctx.textAlign = &quot;start&quot;;\nif(discrim) ctx.fillText(`#${discrim}`, ctx.measureText(name).width + 10 + 316, 164); // Writing discrim\n</code></pre>\n<hr>\n<h2>Level</h2>\n<p>Writing the Level of the user in the card</p>\n<pre><code class=\"language-javascript\">ctx.font = `bold 36px ${font}`;\nctx.fillStyle = '#FFFFFF';\nctx.textAlign = &quot;end&quot;;\nctx.fillText(level, 934 - 64, 82); // const level = level of the user\nctx.fillStyle = &quot;rgba(255, 255, 255, 0.4)&quot;;\nctx.fillText(&quot;LEVEL&quot;, 934 - 64 - ctx.measureText(level).width - 16, 82); // Writing &quot;LEVEL&quot;\n</code></pre>\n<hr>\n<h2>Rank</h2>\n<p>Writing the Rank (<code>#10</code>) of the user in the card</p>\n<pre><code class=\"language-javascript\">ctx.font = `bold 36px ${font}`;\nctx.fillStyle = &quot;#ffffff&quot;;\nctx.textAlign = &quot;end&quot;;\nctx.fillText(rank, 934 - 64 - ctx.measureText(level).width - 16 - ctx.measureText(`LEVEL`).width - 16, 82); // const rank = rank of the user\nctx.fillStyle = &quot;rgba(255, 255, 255, 0.4)&quot;;\nctx.fillText(&quot;RANK&quot;, 934 - 64 - ctx.measureText(level).width - 16 - ctx.measureText(`LEVEL`).width - 16 - ctx.measureText(rank).width - 16, 82); // Writing &quot;RANK&quot;\n</code></pre>\n<hr>\n<h2>Writing Current and Needed EXP</h2>\n<p>You must calculate proper value of current experience points and the maximum expirence point of the current level. This is also needed for progress bar in the card.</p>\n<pre><code class=\"language-javascript\">ctx.font = `bold 36px ${font}`;\nctx.fillStyle = &quot;rgba(255, 255, 255, 0.5)&quot;;\nctx.textAlign = &quot;start&quot;;\nctx.fillText(&quot;/ &quot; + neededXP, 624 + ctx.measureText(currentXP).width + 10, 164);\nctx.fillStyle = &quot;#ffffff&quot;;\nctx.fillText(currentXP, 624, 164);\n</code></pre>\n<hr>\n<h2>Progress bar</h2>\n<p>This is the most complex part of the entire rank card. This might be tricky but everything is possible.</p>\n<pre><code class=\"language-javascript\">ctx.beginPath();\nctx.fillStyle = &quot;#424751&quot;;\nctx.arc(257 + 18.5, 147.5 + 18.5 + 36.25, 18.5, 1.5 * Math.PI, 0.5 * Math.PI, true);\nctx.fill();\nctx.fillRect(257 + 18.5, 147.5 + 36.25, 615 - 18.5, 37.5);\nctx.arc(257 + 615, 147.5 + 18.5 + 36.25, 18.75, 1.5 * Math.PI, 0.5 * Math.PI, false);\nctx.fill();\n\nctx.beginPath();\nctx.fillStyle = &quot;#ffffff&quot;;\nctx.arc(257 + 18.5, 147.5 + 18.5 + 36.25, 18.5, 1.5 * Math.PI, 0.5 * Math.PI, true);\nctx.fill();\nctx.fillRect(257 + 18.5, 147.5 + 36.25, widthXP, 37.5);\nctx.arc(257 + 18.5 + widthXP, 147.5 + 18.5 + 36.25, 18.75, 1.5 * Math.PI, 0.5 * Math.PI, false);\nctx.fill();\n</code></pre>\n<div class=\"admonition info\">\n<p class=\"admonition-title\">info</p>\n<p>If your bar exceeds the bar graph, add the below code before making the progress bar.</p>\n</div>\n<br>\n<pre><code class=\"language-javascript\">let widthXP = (currentXP * 615) / neededXP;\nif (widthXP &gt; 615 - 18.5) widthXP = 615 - 18.5;\n</code></pre>\n<hr>\n<h2>Avatar</h2>\n<p>Finally drawing the avatar of the user</p>\n<pre><code class=\"language-javascript\">const avatar = await Canvas.loadImage(avatarURLoftheUser);\nctx.drawImage(avatar, 85, 66, 150, 150);\n</code></pre>\n<div class=\"admonition info\">\n<p class=\"admonition-title\">info</p>\n<p>If you want a circle avatar you can clip the path before drawing the avatar!</p>\n</div>\n<hr>\n<h2>Getting the Buffer</h2>\n<pre><code class=\"language-javascript\">const card = canvas.toBuffer();\n</code></pre>\n<hr>\n<h2>Full Code</h2>\n<pre><code class=\"language-javascript\">const Canvas = require(&quot;canvas&quot;);\nconst canvas = Canvas.createCanvas(934, 282);\nconst ctx = canvas.getContext(&quot;2d&quot;);\n\nconst rankCard = await Canvas.loadImage(&quot;https://zyrouge.gq/assets/images/others/discord-js-rank-card.png&quot;);\nctx.drawImage(rankCard, 0, 0, canvas.width, canvas.height);\n\nconst font = &quot;Arial&quot;;\n\nctx.font = `bold 36px ${font}`;\nctx.fillStyle = &quot;#FFFFFF&quot;;\nctx.textAlign = &quot;start&quot;;\nconst name = username &gt; 7 ? username.substring(0, 7).trim() + '...' : username;\nctx.fillText(`${name}`, 264, 164);\n\nctx.font = `36px ${font}`;\nctx.fillStyle = &quot;rgba(255, 255, 255, 0.4)&quot;;\nctx.textAlign = &quot;center&quot;;\nif(discrim) ctx.fillText(`#${discrim}`, ctx.measureText(name).width + 10 + 316, 164);\n\nctx.font = `bold 36px ${font}`;\nctx.fillStyle = '#FFFFFF';\nctx.textAlign = &quot;end&quot;;\nctx.fillText(level, 934 - 64, 82);\nctx.fillStyle = &quot;rgba(255, 255, 255, 0.4)&quot;;\nctx.fillText(&quot;LEVEL&quot;, 934 - 64 - ctx.measureText(level).width - 16, 82);\n\nctx.font = `bold 36px ${font}`;\nctx.fillStyle = &quot;#ffffff&quot;;\nctx.textAlign = &quot;end&quot;;\nctx.fillText(rank, 934 - 64 - ctx.measureText(level).width - 16 - ctx.measureText(`LEVEL`).width - 16, 82);\nctx.fillStyle = &quot;rgba(255, 255, 255, 0.4)&quot;;\nctx.fillText(&quot;RANK&quot;, 934 - 64 - ctx.measureText(level).width - 16 - ctx.measureText(`LEVEL`).width - 16 - ctx.measureText(rank).width - 16, 82);\n\nctx.font = `bold 36px ${font}`;\nctx.fillStyle = &quot;rgba(255, 255, 255, 0.5)&quot;;\nctx.textAlign = &quot;start&quot;;\nctx.fillText(&quot;/ &quot; + neededXP, 624 + ctx.measureText(currentXP).width + 10, 164);\nctx.fillStyle = &quot;#ffffff&quot;;\nctx.fillText(currentXP, 624, 164);\n\nlet widthXP = (currentXP * 615) / neededXP;\nif (widthXP &gt; 615 - 18.5) widthXP = 615 - 18.5;\n\nctx.beginPath();\nctx.fillStyle = &quot;#424751&quot;;\nctx.arc(257 + 18.5, 147.5 + 18.5 + 36.25, 18.5, 1.5 * Math.PI, 0.5 * Math.PI, true);\nctx.fill();\nctx.fillRect(257 + 18.5, 147.5 + 36.25, 615 - 18.5, 37.5);\nctx.arc(257 + 615, 147.5 + 18.5 + 36.25, 18.75, 1.5 * Math.PI, 0.5 * Math.PI, false);\nctx.fill();\n\nctx.beginPath();\nctx.fillStyle = &quot;#ffffff&quot;;\nctx.arc(257 + 18.5, 147.5 + 18.5 + 36.25, 18.5, 1.5 * Math.PI, 0.5 * Math.PI, true);\nctx.fill();\nctx.fillRect(257 + 18.5, 147.5 + 36.25, widthXP, 37.5);\nctx.arc(257 + 18.5 + widthXP, 147.5 + 18.5 + 36.25, 18.75, 1.5 * Math.PI, 0.5 * Math.PI, false);\nctx.fill();\n\nconst avatar = await Canvas.loadImage(avatarURL);\nctx.drawImage(avatar, 85, 66, 150, 150);\n\nconst card = canvas.toBuffer();\n</code></pre>\n<hr>\n<h2>Other Examples</h2>\n<p><a href=\"https://github.com/zyrouge/aurora-bot\">Aurora</a>'s rank card:</p>\n<img src=\"https://media.discordapp.net/attachments/594543235607822367/709288549882789899/rank_582836817305272320_521007613475946496.png\">","env":null}